node {
    // Declare myMap at the top level
    def accounts = [:]
    def clusters = [:]
    
    environment {
        AWS_DEFAULT_REGION = 'us-east-1'

        accounts['dev'] = '179438333696'
        accounts['prod'] = '179438333696'
        clusters = ['dev'] = 'Devcluster'
        clusters = ['prod'] = 'Experta_Prod'
        AWS_DEFAULT_REGION  = 'us-east-1'
        AWS_ACCOUNT_ID = accounts.get(params.ENVIRONMENT)
        ECS_CLUSTER = clusters.get(params.ENVIRONMENT)
        REPOSITORY_URI = "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_DEFAULT_REGION}.amazonaws.com"
        DOCKER_IMAGE_TAG_PROGRAM = "${REPOSITORY_URI}/program-service:latest"

        AWS_ECR_REPO = "program-service"
        ECS_SERVICE = "Programservice"
        SNS_TOPIC_ARN = "arn:aws:sns:${AWS_DEFAULT_REGION}:${AWS_ACCOUNT_ID}:jenkins"

    }

    stage('Initialize') {
        // Populate the map

        echo "AWS_ACCOUNT_ID: ${AWS_ACCOUNT_ID}"
        echo "ECS_CLUSTER: ${ECS_CLUSTER}"
    }

    stage('Use Map Data') {
        // Access myMap in the next stage
        echo "Status: ${ECS_CLUSTER}"
    }
}